{"version":3,"sources":["main.es6"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["/* global $ Vue */\r\n'use strict';\r\n\r\n// App data\r\nconst data = {\r\n\tchannelNames: [\r\n\t\t'freecodecamp',\r\n\t\t'ESL_LOL',\r\n\t\t'ESL_SC2',\r\n\t\t'SmoothMcGroove',\r\n\t\t'brunofin',\r\n\t\t'ESL_CSGO',\r\n\t\t'ObamaCareTeam',\r\n\t],\r\n\tstatuses: Object.freeze({\r\n\t\t0: 'online',\r\n\t\t1: 'offline',\r\n\t\t2: 'nonexistent'\r\n\t}),\r\n\tchannelInfos: {\r\n\t\tonline: [\r\n\t\t\t{\r\n\t\t\t\tdisplay_name: 'Test',\r\n\t\t\t\tlogo: 'https://static-cdn.jtvnw.net/jtv_user_pictures/esl_csgo-profile_image-546a0c1883798a41-300x300.jpeg',\r\n\t\t\t\tstatus: 'Test test',\r\n\t\t\t},\r\n\t\t],\r\n\t\toffline: [],\r\n\t\tnonexistent: [],\r\n\t}\r\n};\r\n\r\n\r\n// DOM elements (batched queries for perfomance)\r\nconst DOMElements = {\r\n\tchannels: {\r\n\t\tonline: document.querySelector('.channels__online'),\r\n\t\toffline: document.querySelector('.channels__offline'),\r\n\t\tnonexistent: document.querySelector('.channels__nonexistent'),\r\n\t},\r\n};\r\n\r\n// TODO: add passing any parameters\r\nconst url = function url(endpoint, data, query) {\r\n\treturn `https://api.twitch.tv/kraken/${endpoint}${data ? '/' + data : ''}?api_version=3${query ? `&q=${query}` : ''}`;\r\n};\r\n\r\n// API calls\r\nconst apiCall = function apiCall(callback, url) {\r\n\t$.ajax({\r\n\t\ttype: 'GET',\r\n\t\turl: url,\r\n\t\tcomplete: callback,\r\n\t});\r\n};\r\n\r\nconst getInfos = function getInfos(callback, list) {\r\n\t// curry apiCall function with callback\r\n\tconst get = apiCall.bind(null, callback);\r\n\tconst type = 'streams';\r\n\r\n\tlist.forEach(name => get(url(type, name)));\r\n};\r\n\r\n/**\r\n * Finds out channel's status and saves it in data property accordingly\r\n * @param  {JSON} request\r\n * @param  {string} status\r\n * @return none\r\n */\r\nconst saveChannelInfo = function saveChannelInfo(storage, request, status) {\r\n\tconst response = request.responseJSON;\r\n\r\n\tif (response) {\r\n\t\tif (status === 'error') {\r\n\t\t\tif (response.status === 422) {\r\n\t\t\t\t// user doesn't exist\r\n\t\t\t\tconsole.log('User doesn\\'t exists.');\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconsole.error('API call error:', status, request.responseJSON);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (response.stream) {\r\n\t\t\t\t// channel online\r\n\t\t\t\tstorage.online.push(response.stream.channel);\r\n\t\t\t}\r\n\t\t\telse if (response._id) {\r\n\t\t\t\t// channel offline\r\n\t\t\t\tstorage.offline.push(response);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// make additional request for offline channel's info\r\n\t\t\t\tconst save = saveChannelInfo.bind(null, storage);\r\n\t\t\t\tapiCall(save, response._links.channel);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthrow new Error('No JSON object in response.');\r\n\t}\r\n};\r\n\r\n\r\n// Initializing function\r\nconst init = function init(channelList) {\r\n\tconst save = saveChannelInfo.bind(null, data.channelInfos);\r\n\tgetInfos(save, data.channelNames);\r\n};\r\n\r\n\r\nnew Vue({\r\n\tel: '#app',\r\n\r\n\tdata: {\r\n\t\tchannels: data.channelInfos,\r\n\t\teditMode: false,\r\n\t},\r\n\r\n\tmethods: {\r\n\t\ttoggleEditMode() {\r\n\t\t\tthis.editMode = !this.editMode;\r\n\t\t\treturn this.editMode;\r\n\t\t},\r\n\t},\r\n\r\n\tevents: {\r\n\t\tremoveChannel(id, status) {\r\n\t\t\tconst index = this.channels[status].findIndex(x => x._id === id);\r\n\t\t\tthis.channels[status].$remove(this.channels[status][index]);\r\n\t\t},\r\n\t\taddStream(name) {\r\n\t\t\tconst save = saveChannelInfo.bind(null, this.channels);\r\n\t\t\tapiCall(save, url('streams', this.streamName));\r\n\t\t},\r\n\t},\r\n\r\n\tcomponents: {\r\n\t\tchannel: {\r\n\t\t\ttemplate: '#channel-template',\r\n\r\n\t\t\tprops: ['index', 'channel', 'status', 'edit-mode'],\r\n\r\n\t\t\tmethods: {\r\n\t\t\t\tremoveChannel(index, status) {\r\n\t\t\t\t\tthis.$dispatch('removeChannel', index, status);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t'search-form': {\r\n\t\t\tprops: ['edit-mode'],\r\n\r\n\t\t\tdata: function () {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tstreamName: '',\r\n\t\t\t\t\tsearchResults: [],\r\n\t\t\t\t\tresultsTotal: 0,\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\tcomputed: {\r\n\t\t\t\tresultsShown: function () {\r\n\t\t\t\t\treturn this.searchResults.length;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\tmethods: {\r\n\t\t\t\taddStream(name) {\r\n\t\t\t\t\tthis.$dispatch('addStream', name);\r\n\t\t\t\t},\r\n\t\t\t\tsave(request, status) {\r\n\t\t\t\t\tconst response = request.responseJSON;\r\n\r\n\t\t\t\t\tif (response) {\r\n\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\tthis.resultsTotal = response._total;\r\n\t\t\t\t\t\tthis.searchResults = response.channels;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthrow new Error('No JSON object in response.');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfindStream() {\r\n\t\t\t\t\tif (this.streamName) {\r\n\t\t\t\t\t\tapiCall(this.save, url('search/channels', null, this.streamName));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\tcomponents: {\r\n\t\t\t\t'search-result': {\r\n\t\t\t\t\tprops: ['result'],\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\r\n\tready: init,\r\n});\r\n"]}