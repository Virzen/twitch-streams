{"version":3,"sources":["main.es6"],"names":[],"mappings":";AACA;;;;AAGA,IAAM,OAAO;AACZ,eAAc,CACb,cADa,EAEb,SAFa,EAGb,SAHa,EAIb,gBAJa,EAKb,UALa,EAMb,eANa,CAAd;AAQA,WAAU,OAAO,MAAP,CAAc;AACvB,KAAG,QAAH;AACA,KAAG,SAAH;AACA,KAAG,aAAH;EAHS,CAAV;AAKA,eAAc;AACb,UAAQ;;;;;;GAAR;AAOA,WAAS,EAAT;AACA,eAAa,EAAb;EATD;CAdK;;;AA6BN,IAAM,cAAc;AACnB,WAAU;AACT,UAAQ,SAAS,aAAT,CAAuB,mBAAvB,CAAR;AACA,WAAS,SAAS,aAAT,CAAuB,oBAAvB,CAAT;AACA,eAAa,SAAS,aAAT,CAAuB,wBAAvB,CAAb;EAHD;CADK;;;AASN,IAAM,YAAY,SAAS,SAAT,CAAmB,QAAnB,EAA6B,IAA7B,EAAmC,KAAnC,EAA0C;AAC3D,0CAAuC,YAAW,OAAO,MAAM,IAAN,GAAa,EAApB,wBAAuC,gBAAc,KAAd,GAAwB,EAAxB,CAAzF,CAD2D;CAA1C;;;AAKlB,IAAM,UAAU,SAAS,OAAT,CAAiB,QAAjB,EAA2B,GAA3B,EAAgC;AAC/C,GAAE,IAAF,CAAO;AACN,QAAM,KAAN;AACA,OAAK,GAAL;AACA,YAAU,QAAV;EAHD,EAD+C;CAAhC;;AAQhB,IAAM,WAAW,SAAS,QAAT,CAAkB,QAAlB,EAA4B,IAA5B,EAAkC;;AAElD,KAAM,MAAM,QAAQ,IAAR,CAAa,IAAb,EAAmB,QAAnB,CAAN,CAF4C;AAGlD,KAAM,OAAO,SAAP,CAH4C;;AAKlD,MAAK,OAAL,CAAa;SAAQ,IAAI,UAAU,IAAV,EAAgB,IAAhB,CAAJ;EAAR,CAAb,CALkD;CAAlC;;;;;;;;AAcjB,IAAM,kBAAkB,SAAS,eAAT,CAAyB,OAAzB,EAAkC,OAAlC,EAA2C,MAA3C,EAAmD;AAC1E,KAAM,WAAW,QAAQ,YAAR,CADyD;;AAG1E,KAAI,QAAJ,EAAc;AACb,MAAI,WAAW,OAAX,EAAoB;AACvB,OAAI,SAAS,MAAT,KAAoB,GAApB,EAAyB;;AAE5B,YAAQ,GAAR,CAAY,uBAAZ,EAF4B;IAA7B,MAIK;AACJ,YAAQ,KAAR,CAAc,iBAAd,EAAiC,MAAjC,EAAyC,QAAQ,YAAR,CAAzC,CADI;IAJL;GADD,MASK;AACJ,OAAI,SAAS,MAAT,EAAiB;;AAEpB,YAAQ,MAAR,CAAe,IAAf,CAAoB,SAAS,MAAT,CAAgB,OAAhB,CAApB,CAFoB;IAArB,MAIK,IAAI,SAAS,GAAT,EAAc;;AAEtB,YAAQ,OAAR,CAAgB,IAAhB,CAAqB,QAArB,EAFsB;IAAlB,MAIA;;AAEJ,QAAM,OAAO,gBAAgB,IAAhB,CAAqB,IAArB,EAA2B,OAA3B,CAAP,CAFF;AAGJ,YAAQ,IAAR,EAAc,SAAS,MAAT,CAAgB,OAAhB,CAAd,CAHI;IAJA;GAdN;EADD,MA0BK;AACJ,QAAM,IAAI,KAAJ,CAAU,6BAAV,CAAN,CADI;EA1BL;CAHuB;;;AAoCxB,IAAM,OAAO,SAAS,IAAT,CAAc,WAAd,EAA2B;AACvC,KAAM,OAAO,gBAAgB,IAAhB,CAAqB,IAArB,EAA2B,KAAK,YAAL,CAAlC,CADiC;AAEvC,UAAS,IAAT,EAAe,KAAK,YAAL,CAAf,CAFuC;CAA3B;;AAMb,IAAI,GAAJ,CAAQ;AACP,KAAI,MAAJ;;AAEA,OAAM;AACL,gBAAc,KAAK,YAAL;AACd,YAAU,KAAK,YAAL;AACV,YAAU,KAAV;EAHD;;AAMA,UAAS;AACR,4CAAiB;AAChB,QAAK,QAAL,GAAgB,CAAC,KAAK,QAAL,CADD;AAEhB,UAAO,KAAK,QAAL,CAFS;GADT;EAAT;;AAOA,SAAQ;AACP,wCAAc,IAAI,QAAQ;AACzB,OAAM,UAAU,KAAK,QAAL,CAAc,MAAd,EAAsB,IAAtB,CAA2B;WAAK,EAAE,GAAF,KAAU,EAAV;IAAL,CAArC,CADmB;AAEzB,QAAK,QAAL,CAAc,MAAd,EAAsB,OAAtB,CAA8B,OAA9B,EAFyB;AAGzB,QAAK,YAAL,CAAkB,OAAlB,CAA0B,QAAQ,IAAR,CAA1B,CAHyB;GADnB;AAMP,gCAAU,MAAM;AACf,OAAM,WAAW,KAAK,QAAL,CAAc,MAAd,CAAqB,IAArB,CAA0B;WAAW,QAAQ,IAAR,KAAiB,IAAjB;IAAX,CAArC,CADS;AAEf,OAAM,YAAY,KAAK,QAAL,CAAc,OAAd,CAAsB,IAAtB,CAA2B;WAAW,QAAQ,IAAR,KAAiB,IAAjB;IAAX,CAAvC,CAFS;AAGf,OAAM,WAAW,CAAC,QAAD,IAAa,CAAC,SAAD,CAHf;;AAKf,OAAI,QAAJ,EAAc;AACb,QAAM,OAAO,gBAAgB,IAAhB,CAAqB,IAArB,EAA2B,KAAK,QAAL,CAAlC,CADO;AAEb,YAAQ,IAAR,EAAc,UAAU,SAAV,EAAqB,IAArB,CAAd,EAFa;AAGb,SAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,EAHa;IAAd;GAXM;EAAR;;AAmBA,aAAY;AACX,WAAS;AACR,aAAU,mBAAV;;AAEA,UAAO,CAAC,OAAD,EAAU,SAAV,EAAqB,QAArB,EAA+B,WAA/B,CAAP;;AAEA,YAAS;AACR,0CAAc,OAAO,QAAQ;AAC5B,UAAK,SAAL,CAAe,eAAf,EAAgC,KAAhC,EAAuC,MAAvC,EAD4B;KADrB;IAAT;GALD;;AAYA,iBAAe;AACd,UAAO,CAAC,WAAD,CAAP;;AAEA,SAAM,gBAAY;AACjB,WAAO;AACN,iBAAY,EAAZ;AACA,oBAAe,EAAf;AACA,mBAAc,CAAd;AACA,uBAAkB,EAAlB;KAJD,CADiB;IAAZ;;AASN,aAAU;AACT,mBAAe,yBAAY;AAC1B,YAAO,KAAK,aAAL,CAAmB,MAAnB,CADmB;KAAZ;IADhB;;AAMA,YAAS;AACR,wCAAc;;;AACb,SAAI,KAAK,gBAAL,EAAuB;;AAC1B,WAAM,UAAN;AACA,aAAK,gBAAL,CAAsB,OAAtB,CAA8B,gBAAQ;AACrC,WAAG,SAAH,CAAa,WAAb,EAA0B,IAA1B,EADqC;QAAR,CAA9B;WAF0B;MAA3B;KAFO;AASR,wBAAK,SAAS,QAAQ;AACrB,SAAM,WAAW,QAAQ,YAAR,CADI;;AAGrB,SAAI,QAAJ,EAAc;AACb,cAAQ,GAAR,CAAY,QAAZ,EADa;AAEb,WAAK,YAAL,GAAoB,SAAS,MAAT,CAFP;AAGb,WAAK,aAAL,GAAqB,SAAS,QAAT,CAHR;MAAd,MAKK;AACJ,YAAM,IAAI,KAAJ,CAAU,6BAAV,CAAN,CADI;MALL;KAZO;AAqBR,oCAAW,OAAO,KAAK;AACtB,SAAI,KAAK,UAAL,EAAiB;AACpB,YAAM,OAAO,UAAU,iBAAV,EAA6B,IAA7B,EAAmC,KAAK,UAAL,CAA1C,CADc;;AAGpB,cAAQ,KAAK,IAAL,EAAW,GAAnB,EAHoB;MAArB;KAtBO;IAAT;GAlBD;EAbD;;AA+DA,QAAO,IAAP;CAlGD","file":"main.js","sourcesContent":["/* global $ Vue */\r\n'use strict';\r\n\r\n// App data\r\nconst data = {\r\n\tchannelNames: [\r\n\t\t'freecodecamp',\r\n\t\t'esl_lol',\r\n\t\t'esl_sc2',\r\n\t\t'smoothmcgroove',\r\n\t\t'esl_csgo',\r\n\t\t'obamacareteam',\r\n\t],\r\n\tstatuses: Object.freeze({\r\n\t\t0: 'online',\r\n\t\t1: 'offline',\r\n\t\t2: 'nonexistent'\r\n\t}),\r\n\tchannelInfos: {\r\n\t\tonline: [\r\n\t\t\t// {\r\n\t\t\t// \tdisplay_name: 'Test',\r\n\t\t\t// \tlogo: 'https://static-cdn.jtvnw.net/jtv_user_pictures/esl_csgo-profile_image-546a0c1883798a41-300x300.jpeg',\r\n\t\t\t// \tstatus: 'Test test',\r\n\t\t\t// },\r\n\t\t],\r\n\t\toffline: [],\r\n\t\tnonexistent: [],\r\n\t}\r\n};\r\n\r\n\r\n// DOM elements (batched queries for perfomance)\r\nconst DOMElements = {\r\n\tchannels: {\r\n\t\tonline: document.querySelector('.channels__online'),\r\n\t\toffline: document.querySelector('.channels__offline'),\r\n\t\tnonexistent: document.querySelector('.channels__nonexistent'),\r\n\t},\r\n};\r\n\r\n// TODO: add passing any parameters\r\nconst createUrl = function createUrl(endpoint, data, query) {\r\n\treturn `https://api.twitch.tv/kraken/${endpoint}${data ? '/' + data : ''}?api_version=3${query ? `&q=${query}` : ''}`;\r\n};\r\n\r\n// API calls\r\nconst apiCall = function apiCall(callback, url) {\r\n\t$.ajax({\r\n\t\ttype: 'GET',\r\n\t\turl: url,\r\n\t\tcomplete: callback,\r\n\t});\r\n};\r\n\r\nconst getInfos = function getInfos(callback, list) {\r\n\t// curry apiCall function with callback\r\n\tconst get = apiCall.bind(null, callback);\r\n\tconst type = 'streams';\r\n\r\n\tlist.forEach(name => get(createUrl(type, name)));\r\n};\r\n\r\n/**\r\n * Finds out channel's status and saves it in data property accordingly\r\n * @param  {JSON} request\r\n * @param  {string} status\r\n * @return none\r\n */\r\nconst saveChannelInfo = function saveChannelInfo(storage, request, status) {\r\n\tconst response = request.responseJSON;\r\n\r\n\tif (response) {\r\n\t\tif (status === 'error') {\r\n\t\t\tif (response.status === 422) {\r\n\t\t\t\t// user doesn't exist\r\n\t\t\t\tconsole.log('User doesn\\'t exists.');\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconsole.error('API call error:', status, request.responseJSON);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (response.stream) {\r\n\t\t\t\t// channel online\r\n\t\t\t\tstorage.online.push(response.stream.channel);\r\n\t\t\t}\r\n\t\t\telse if (response._id) {\r\n\t\t\t\t// channel offline\r\n\t\t\t\tstorage.offline.push(response);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// make additional request for offline channel's info\r\n\t\t\t\tconst save = saveChannelInfo.bind(null, storage);\r\n\t\t\t\tapiCall(save, response._links.channel);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthrow new Error('No JSON object in response.');\r\n\t}\r\n};\r\n\r\n\r\n// Initializing function\r\nconst init = function init(channelList) {\r\n\tconst save = saveChannelInfo.bind(null, data.channelInfos);\r\n\tgetInfos(save, data.channelNames);\r\n};\r\n\r\n\r\nnew Vue({\r\n\tel: '#app',\r\n\r\n\tdata: {\r\n\t\tchannelNames: data.channelNames,\r\n\t\tchannels: data.channelInfos,\r\n\t\teditMode: false\r\n\t},\r\n\r\n\tmethods: {\r\n\t\ttoggleEditMode() {\r\n\t\t\tthis.editMode = !this.editMode;\r\n\t\t\treturn this.editMode;\r\n\t\t}\r\n\t},\r\n\r\n\tevents: {\r\n\t\tremoveChannel(id, status) {\r\n\t\t\tconst channel = this.channels[status].find(x => x._id === id);\r\n\t\t\tthis.channels[status].$remove(channel);\r\n\t\t\tthis.channelNames.$remove(channel.name);\r\n\t\t},\r\n\t\taddStream(name) {\r\n\t\t\tconst inOnline = this.channels.online.find(channel => channel.name === name);\r\n\t\t\tconst inOffline = this.channels.offline.find(channel => channel.name === name);\r\n\t\t\tconst notAdded = !inOnline && !inOffline;\r\n\r\n\t\t\tif (notAdded) {\r\n\t\t\t\tconst save = saveChannelInfo.bind(null, this.channels);\r\n\t\t\t\tapiCall(save, createUrl('streams', name));\r\n\t\t\t\tthis.channelNames.push(name);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tcomponents: {\r\n\t\tchannel: {\r\n\t\t\ttemplate: '#channel-template',\r\n\r\n\t\t\tprops: ['index', 'channel', 'status', 'edit-mode'],\r\n\r\n\t\t\tmethods: {\r\n\t\t\t\tremoveChannel(index, status) {\r\n\t\t\t\t\tthis.$dispatch('removeChannel', index, status);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'search-form': {\r\n\t\t\tprops: ['edit-mode'],\r\n\r\n\t\t\tdata: function () {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tstreamName: '',\r\n\t\t\t\t\tsearchResults: [],\r\n\t\t\t\t\tresultsTotal: 0,\r\n\t\t\t\t\tselectedChannels: [],\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\tcomputed: {\r\n\t\t\t\tresultsNumber: function () {\r\n\t\t\t\t\treturn this.searchResults.length;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tmethods: {\r\n\t\t\t\taddSelected() {\r\n\t\t\t\t\tif (this.selectedChannels) {\r\n\t\t\t\t\t\tconst vm = this;\r\n\t\t\t\t\t\tthis.selectedChannels.forEach(name => {\r\n\t\t\t\t\t\t\tvm.$dispatch('addStream', name);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsave(request, status) {\r\n\t\t\t\t\tconst response = request.responseJSON;\r\n\r\n\t\t\t\t\tif (response) {\r\n\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\tthis.resultsTotal = response._total;\r\n\t\t\t\t\t\tthis.searchResults = response.channels;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthrow new Error('No JSON object in response.');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfindStream(event, url) {\r\n\t\t\t\t\tif (this.streamName) {\r\n\t\t\t\t\t\turl = url || createUrl('search/channels', null, this.streamName);\r\n\r\n\t\t\t\t\t\tapiCall(this.save, url);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tready: init\r\n});\r\n"]}